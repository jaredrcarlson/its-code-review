import{_ as x,u as T,f as y,D,v as p,g as f,k as u,x as I,P as r,m as C,O as w,r as B,o as l,c as a,a as o,I as M,G as g,J as k,i as d,t as v,F as R,h as A,j as b,q as E,b as S,w as j,K as V}from"./index-04b1d668.js";const Y={setup(){const c=T(),s=y(!1),h=y({});let e=y(!1);async function _(){try{const t=c.params.clubId;await V.getBooksByClubId(t)}catch(t){r.error(t.message)}}return D(()=>{_(c.params.clubId)}),{steps:[{target:"#v-step-0",header:{title:"Here's a section About the club here to gain user interest"},content:"This includes buttons for a user to join or leave the club, or if you're the creator of the club, you can Edit or Delete your club."}],tourCallBacks:{onFinish:()=>p.editAccount({needsTour:!1}),onSkip:()=>p.editAccount({needsTour:!1})},editable:h,isEditing:s,currentBooks:f(()=>u.books.filter(i=>i.status=="reading")),selectedClub:f(()=>u.selectedClub),inClub:f(()=>{const t=u.myMemberships.find(i=>i.clubId==c.params.clubId);return t||{}}),account:f(()=>u.account),myMemberships:f(()=>u.myMemberships),loadingRef:e,route:c,enableEditing(){s.value=!0,h.value={...u.selectedClub}},async editClub(){try{const t=h.value;await I.editClub(t),s.value=!1}catch(t){r.error(t.message)}},async becomeMember(){try{e.value=!0;const i={clubId:c.params.clubId};await C.becomeMember(i),u.selectedClub.memberCount++,r.success("You are now a member of this club."),e.value=!1}catch(t){r.error(t.message)}},async addRequest(){try{e.value=!0;const i={clubId:c.params.clubId};await C.becomeMember(i),r.toast("You have requested to join this club.","success","bottom-end"),e.value=!1}catch(t){r.error(t.message)}},async leaveClub(){try{if(!await r.confirm("Are you sure you want to leave this club?"))return;e.value=!0;const m=u.myMemberships.find(n=>n.clubId==c.params.clubId).id;await C.leaveClub(m),u.selectedClub.memberCount--,r.success("You have left this club."),e.value=!1,w.push({name:"Home"})}catch(t){r.error(t.message)}},async removeRequest(){try{if(!await r.confirm("Are you sure you want to remove this request?"))return;e.value=!0;const m=u.myMemberships.find(n=>n.clubId==c.params.clubId).id;await C.leaveClub(m),r.toast("Your request has been removed","success","bottom-end"),e.value=!1}catch(t){r.error(t.message)}},async deleteClub(){try{if(!await r.confirm("Deleting your club is permanent, are you sure you want to let down your members?"))return;const i=c.params.clubId;await I.deleteClub(i),w.push({name:"Home"})}catch(t){r.error(t.message)}}}}},J={class:"container-fluid"},L={class:"row",id:"v-step-0"},N={class:"col-12 mt-3 dark-blue-bg rounded elevation-3 text-light"},F={class:"p-3"},H=o("p",{class:"fs-3 fw-bold"},"About us",-1),P={key:3,class:"fs-4"},U={key:4,type:"submit",class:"btn light-blue-btn"},G={class:"fs-4"},K=o("span",{class:"pe-2 fw-semibold"},"Currently Reading:",-1),O={class:"text-light"},z={key:0},Q={class:"d-flex justify-content-between mt-5 align-items-end"},W={class:"fs-3"},X=o("i",{class:"mdi mdi-account"},null,-1),Z={class:"fw-light fs-5"},$={class:"pe-5"},ee={key:0},te=o("i",{class:"mdi mdi-account-minus"},null,-1),se={key:1,class:"btn orange-btn fs-3",title:"You've been blocked!",disabled:""},oe=o("i",{class:"mdi mdi-cancel"},null,-1),ne=o("i",{class:"mdi mdi-account-minus"},null,-1),le=o("i",{class:"mdi mdi-account-plus"},null,-1),ae=o("i",{class:"mdi mdi-account-plus"},null,-1),re={key:1};function ie(c,s,h,e,_,t){const i=B("router-link"),m=B("Tour");return l(),a(R,null,[o("div",J,[o("section",L,[o("div",N,[o("div",F,[H,o("form",{onSubmit:s[3]||(s[3]=M(n=>e.editClub(),["prevent"]))},[e.isEditing?g((l(),a("input",{key:0,placeholder:"club name...","onUpdate:modelValue":s[0]||(s[0]=n=>e.editable.name=n),class:"form-control mb-2",type:"text",required:"",maxlength:"40",minlength:"3"},null,512)),[[k,e.editable.name]]):d("",!0),e.isEditing?g((l(),a("input",{key:1,placeholder:"club cover photo...","onUpdate:modelValue":s[1]||(s[1]=n=>e.editable.coverImg=n),class:"form-control mb-2",type:"url",maxlength:"300",minlength:"3",required:""},null,512)),[[k,e.editable.coverImg]]):d("",!0),e.isEditing?g((l(),a("textarea",{key:2,class:"form-control mb-2",minlength:"3",maxlength:"750",required:"","onUpdate:modelValue":s[2]||(s[2]=n=>e.editable.description=n),rows:"10"},null,512)),[[k,e.editable.description]]):(l(),a("p",P,v(e.selectedClub.description),1)),e.isEditing?(l(),a("button",U,"Save Changes")):d("",!0)],32),o("div",null,[o("p",G,[K,(l(!0),a(R,null,A(e.currentBooks,(n,q)=>(l(),a("span",{key:n.id,class:"pe-2"},[S(i,{to:{name:"Book Details",params:{gbId:n.gbId}}},{default:j(()=>[o("span",O,[b(v(n.title)+" by "+v(n.author)+" ",1),q!=e.currentBooks.length-1?(l(),a("span",z,",")):d("",!0)])]),_:2},1032,["to"])]))),128))])]),o("div",Q,[o("p",W,[X,b(" "+v(e.selectedClub.memberCount),1)]),o("p",Z,[o("span",$," Created on: "+v(e.selectedClub.createdAt.toLocaleDateString()),1)]),e.loadingRef==!1&&e.account.id&&Array.isArray(e.myMemberships)&&e.selectedClub.creatorId!=e.account.id?(l(),a("div",ee,[e.inClub.status=="joined"?(l(),a("button",{key:0,class:"btn orange-btn fs-3",onClick:s[4]||(s[4]=n=>e.leaveClub()),title:"Leave Club"},[te,b(" Leave Club ")])):e.inClub.status=="blocked"?(l(),a("button",se,[oe,b(" Blocked from Club ")])):e.inClub.status=="pending"?(l(),a("button",{key:2,class:"btn orange-btn fs-3",onClick:s[5]||(s[5]=n=>e.removeRequest()),title:"Remove request to join Club"},[ne,b(" Remove Request ")])):e.selectedClub.private?(l(),a("button",{key:3,class:"btn light-blue-btn fs-3",onClick:s[6]||(s[6]=n=>e.addRequest()),title:"Request to join club"},[le,b(" Request to Join ")])):(l(),a("button",{key:4,class:"btn light-blue-btn fs-3",onClick:s[7]||(s[7]=n=>e.becomeMember()),title:"Join Club"},[ae,b(" Join Club ")]))])):d("",!0),e.selectedClub.creatorId==e.account.id?(l(),a("div",re,[o("button",{onClick:s[8]||(s[8]=n=>e.enableEditing()),class:"btn light-blue-btn fs-3 me-2"},"Edit Club"),o("button",{onClick:s[9]||(s[9]=n=>e.deleteClub()),class:"btn orange-btn fs-3"},"Delete Club")])):d("",!0)])])])])]),e.account.needsTour?(l(),E(m,{key:0,steps:e.steps,callbacks:e.tourCallBacks},null,8,["steps","callbacks"])):d("",!0)],64)}const ue=x(Y,[["render",ie]]);export{ue as default};
